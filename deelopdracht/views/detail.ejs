<%- include ("partials/sidebar.ejs") %>
<main class="detailmain">
    <h1>Details</h1>
    <section id="details">
        <article class="playercard <%= clickedCard.rarity.toLowerCase() %>">
            <div class="cost"><%= clickedCard.cost %></div>
            <div class="power"><%= clickedCard.power %></div>
            <img src="<%= clickedCard.name %>" alt="Name of character" class="nameplate">
            <img src="<%= clickedCard.logo %>" alt="Card artwork of character" class="artwork">
        </article>
        <article class="info">
            <h2>Ability: </h2>
            <p><%= clickedCard.description %></p>
            <h3>Additional info: </h3>
            <article id="additional">
                <p>Date added: <%= clickedCard.dateadded %></p>
                <article id="tags">
                    <p>Tags:</p>
                    <% if (Array.isArray(clickedCard.tags)) { %>
                        <ul>
                            <% clickedCard.tags.forEach(tag => { %>
                                <li><%= tag.trim() %></li>
                            <% }); %>
                        </ul>
                    <% } else if (typeof clickedCard.tags === 'string') { %>
                        <ul>
                            <% clickedCard.tags.split(',').forEach(tag => { %>
                                <li><%= tag.trim() %></li>
                            <% }); %>
                        </ul>
                    <% } else { %>
                        <p>No tags available</p>
                    <% } %>
                </article>
            </article>    
            <h1>Related Groups:</h1>
            <article id="related">
                <% if (clickedCard.group) { %>
                    <a href="/groupdetail/<%= clickedCard.group.id %>">
                        <img class="groupcard" src="<%= clickedCard.group.logo %>" alt="Group logo" width="15%" height="auto">
                    </a>
                <% } %>
            </article>
        </article>
    </section>
    <% if (isAdmin) { %>
    <h1>Edit Character</h1>
    <section id="editor">
        <form action="/detail/<%= clickedCard.id %>/update" method="POST">
            <div>
                <label for="cost">Cost:</label>
                <input type="text" id="cost" name="cost" value="<%= clickedCard.cost %>" required>
            </div>
            <div>
                <label for="power">Power:</label>
                <input type="text" id="power" name="power" value="<%= clickedCard.power %>" required>
            </div>
            <div>
                <label for="tags">Tags:</label>
                <input type="text" id="tags" name="tags" value="<%= clickedCard.tags %>" required>
            </div>
            <div>
                <label for="description">Ability:</label>
                <textarea id="description" name="description" rows="4" cols="50" required><%= clickedCard.description %></textarea>
            </div>
            <button type="submit">Update User</button>
        </form>
    </section>
    <% } %>
</main>
</body>
<%- include ("partials/footer.ejs") %>